<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="ISO-8859-1">
<title>Budget Tracker</title>
<link rel="stylesheet" href="/css/dashboard.css">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7"
	crossorigin="anonymous">
<script type="text/javascript"
	src="https://www.gstatic.com/charts/loader.js"></script>
</head>
<body>
	<div id="header">
		<h1>Budget Tracker</h1>
	</div>
	<nav class="navbar navbar-expand-lg bg-body-tertiary"
		id="navigationBar">
		<div class="container-fluid">
			<a class="navbar-brand" href="#">Menu</a>
			<button class="navbar-toggler" type="button"
				data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
				aria-controls="navbarSupportedContent" aria-expanded="false"
				aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav me-auto mb-2 mb-lg-0">
					<li class="nav-item"><a class="nav-link active"
						aria-current="page" href="#">Dashboard</a></li>
					</li>
					<li class="nav-item dropdown"><a
						class="nav-link dropdown-toggle" href="#" role="button"
						data-bs-toggle="dropdown" aria-expanded="false"> Profile </a>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item"
								th:href="@{/edit-profile/{id}(id=${profile.id})}">Edit
									profile</a></li>
							<li><a class="dropdown-item"
								th:href="@{/delete-profile/{id}(id=${profile.id})}"
								onclick="return confirm('Are you sure you want to delete this profile ?')">Delete
									profile</a></li>
						</ul></li>
				</ul>
				<form class="d-flex" th:action="@{/}">
					<button class="btn" type="submit"
						style="background-color: #2a68f7; color: white">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
							fill="currentColor" class="bi bi-house-fill" viewBox="0 0 16 16">
				  <path
								d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L8 2.207l6.646 6.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293z" />
				  <path
								d="m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293z" />
				</svg>
						Home
					</button>
				</form>
			</div>
		</div>
	</nav>
	<div id="topPart">
		<div id="profileDetails">
			<span> <svg xmlns="http://www.w3.org/2000/svg" width="35"
					height="35" fill="currentColor" class="bi bi-person-fill"
					viewBox="0 0 16 16">
				  <path
						d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6" />
				</svg> <span class="ms-1" th:text="${profile.name}"></span>
			</span> <input type="hidden" id="id" th:value="${profile.id}" />
		</div>
		<div>
			<button class="btn"
				th:onclick="'window.location.href=\'' + @{/add-budget/{id}(id=${profile.id})} + '\''">
				<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
					fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
				  <path fill-rule="evenodd"
						d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2" />
				</svg>
				Add Transaction
			</button>
		</div>
	</div>
	<div id="date">
		<div>
			<button class="btn" onclick="changeMonth('-')"
				id="monthDecreaseButton">
				<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
					fill="currentColor" class="bi bi-caret-left-fill"
					viewBox="0 0 16 16">
				  <path
						d="m3.86 8.753 5.482 4.796c.646.566 1.658.106 1.658-.753V3.204a1 1 0 0 0-1.659-.753l-5.48 4.796a1 1 0 0 0 0 1.506z" />
				</svg>
			</button>
			<span th:text="${month}" id="month"></span>
			<button class="btn" onclick="changeMonth('+')"
				id="monthIncreaseButton" disabled>
				<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
					fill="currentColor" class="bi bi-caret-right-fill"
					viewBox="0 0 16 16">
				  <path
						d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z" />
				</svg>
			</button>
			<button class="ms-2 btn" onclick="changeYear('-')"
				id="yearDecreaseButton">
				<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
					fill="currentColor" class="bi bi-caret-left-fill"
					viewBox="0 0 16 16">
				  <path
						d="m3.86 8.753 5.482 4.796c.646.566 1.658.106 1.658-.753V3.204a1 1 0 0 0-1.659-.753l-5.48 4.796a1 1 0 0 0 0 1.506z" />
				</svg>
			</button>
			<span th:text="${year}" id="year"></span>
			<button class="btn" onclick="changeYear('+')" id="yearIncreaseButton"
				disabled>
				<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
					fill="currentColor" class="bi bi-caret-right-fill"
					viewBox="0 0 16 16">
				  <path
						d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z" />
				</svg>
			</button>
		</div>
	</div>
	<div id="budgetDetails">
		<div class="subBudget">
			<h4>Total Income</h4>
			<p>
				&#8377;<span th:text="${totalIncome}" class="ms-2"></span>
			</p>
		</div>
		<div class="subBudget">
			<h4>Total Expenses</h4>
			<p>
				&#8377;<span th:text="${totalExpense}" class="ms-2"></span>
			</p>
		</div>
		<div class="subBudget">
			<h4>Budget Remaining</h4>
			<p>
				&#8377;<span th:text="${remainingBudget}" class="ms-2"></span>
			</p>
		</div>
	</div>
	<div id="graphDivision1">
		<div class="graph1" id="budgetAnalysis"></div>
		<div class="graph1" id="incomeVsExpense"></div>
	</div>
	<div id="graphDivision2">
		<div class="graph2" id="expenseAnalysis"></div>
		<div class="graph2" id="comparisonOverMonths"></div>
	</div>
	<div id="recentTransaction">
		<h2>Recent Transactions</h2>
		<div id="viewAllTransactions" th:unless="${#lists.isEmpty(recentTransactions)}">
			<form th:action="@{/view-all-transactions}" method="get">
				<input type="hidden" th:value="${profile.id}" id="idValue"
					name="idValue"> <input type="hidden" th:value="${month}"
					id="monthName" name="monthName"> <input type="hidden"
					th:value="${year}" id="yearValue" name="yearValue">
				<button class="btn" type="submit">View all transactions</button>
			</form>
		</div>
		<table class="table w-75 mx-auto mt-2">
			<thead>
				<tr>
					<th scope="col">Date</th>
					<th scope="col">Category</th>
					<th scope="col">Amount</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="transaction:${recentTransactions}">
					<td th:text="${transaction.date}"></td>
					<td th:if="${transaction.category}=='Expense'" class="text-danger">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
							fill="currentColor" class="bi bi-caret-down-fill"
							viewBox="0 0 16 16">
						  <path
								d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z" />
						</svg> <span th:text="${transaction.category}"></span>
					</td>
					<td th:if="${transaction.category}=='Income'" class="text-success">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
							fill="currentColor" class="bi bi-caret-up-fill"
							viewBox="0 0 16 16">
						  <path
								d="m7.247 4.86-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z" />
						</svg> <span th:text="${transaction.category}"></span>
					</td>
					<td th:text="'&#8377; '+${transaction.amount}"></td>
				</tr>
			</tbody>
		</table>
	</div>
	<div style="width: 100%; height: 50px; position: relative; top: 350px;"></div>
	<div id="footer"></div>
	<script id="data" type="application/json" th:inline="javascript">
		{
			"totalIncome":[[${totalIncome}]],
			"totalExpense":[[${totalExpense}]],
			"remainingBudget":[[${remainingBudget}]],
			"expenseAnalysis":[[${expenseAnalysis}]],
			"monthlyComparison":[[${monthlyComparison}]]
		}
	</script>
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq"
		crossorigin="anonymous"></script>
	<script src="/js/dashboard.js"></script>
</body>
</html>